# DRRR ChatBot Extension Setting Manual

## Installation

PC version:

Since it is a Chrome extension, please use the Chrome browser and install it from the [Google Web Store](https://chrome.google.com/webstore/detail/drrr-chatbot-extension/fkmpnkcjocenkliehpdhlfbmdmdnokgm).

In addition, if you use Opera, you can try Opera [Install Chrome Extensions](https://addons.opera.com/zh-tw/extensions/details/install-chrome-extensions/).

Mobile version:

The mobile version of Chrome does not provide plugin installation on the phone, but you can use the Yandex browser ([Android](https://play.google.com/store/apps/details?id=ru.yandex.searchplugin&hlen_US), [iOS](https://apps.apple.com/tw/app/yandex-browser/id483693909)), it uses Chrome kernel, so it can also get the installation from [Google Web App Store](https://chrome.google.com/webstore/detail/drrr-chatbot-extension/fkmpnkcjocenkliehpdhlfbmdmdnokgm).


## User interface


<i class="glyphicon glyphicon-question-sign"></i> Go to this help page <i class="glyphicon glyphicon-cog"></i> Go to background settings

![](https://i.imgur.com/Z1JZkdd.png)


### Function switch <br>(<i class="glyphicon glyphicon-cog"></i> means you must do some setting before you turning it on)

![](https://i.imgur.com/jctHIHN.png)

- AutoDM
  Automatically lock the last dm user after sending a message
- Timer <i class="glyphicon glyphicon-cog"></i>
  Scheduled execution of set actions
- Black / Whitelist <i class="glyphicon glyphicon-cog"></i>
  Room black / white list (auto kick out/ban/report visitors)
- Welcome <i class="glyphicon glyphicon-cog"></i>
  Automatically send out a greeting on visitors entering the room
- BanAbuse <i class="glyphicon glyphicon-cog"></i>
  List of banned words. When the user's words match the forbidden words, they will be kicked out automatically.
- Always/me
  Add the /me command automatically
- EventAction
  When the event occurs, perform the set action
- RoomKeeper
  Automatically send messages to yourself to prevent the room from disappearing
- TgBotLogger
  Record chat messages via Telegram Bot
- RoomNotification
  Send chat notification when browser tab is not on chatroom page

### Features tab

#### Bio

![](https://i.imgur.com/hW9d7oS.png)

üîñ Current login account
üíæ Saved account
<i class="glyphicon glyphicon-transfer"></i> Switch the selected account
<i class="glyphicon glyphicon-floppy-save"></i> Save the current account
<i class="glyphicon glyphicon-floppy-remove"></i> delete the selected account
<i class="glyphicon glyphicon-qrcode"></i> tripcode explorer

#### Friends

![](https://i.imgur.com/myrXucu.png)

##### Waiting room function

Check whether the room is available at regular intervals, and if so, jump to that room.

Match rule pattern:
- <i class="glyphicon glyphicon-barcode"></i> by room ID
- <i class="glyphicon glyphicon-lock"></i> with tripcode
- <i class="glyphicon glyphicon-user"></i> by username
- <i class="glyphicon glyphicon-home"></i> by room name

<i class="glyphicon glyphicon-tag"></i> Store rules

- <i class="glyphicon glyphicon-send"></i> Jump directly
- <i class="glyphicon glyphicon-comment"></i> Ask before jumping

##### Searching for users / rooms

Search mode:
- <i class="glyphicon glyphicon-lock"></i> search by tripcode
- <i class="glyphicon glyphicon-user"></i> search by username
- <i class="glyphicon glyphicon-home"></i> search by room name

<i class="glyphicon glyphicon-search"></i> search
<i class="glyphicon glyphicon-plus"></i> Add to favorites

##### Favorites notification / list

<i class="glyphicon glyphicon-volume-up"></i> Open favorites notice (someone goes online or creates a room)
<i class="glyphicon glyphicon-list"></i> Show all favorites rules
<i class="glyphicon glyphicon-lock"></i> Show all matching tripcode users online
<i class="glyphicon glyphicon-user"></i> Show all users who meet the rules online
<i class="glyphicon glyphicon-home"></i> Show all rooms that meet the rules on the line
<i class="glyphicon glyphicon-globe"></i> Show all rooms online

#### Music


![](https://i.imgur.com/w60X55P.png)


##### Play mode (click to switch)
- <i class="glyphicon glyphicon-cd"></i> List mode: After the song ends, the song in the playlist is automatically played
- <i class="glyphicon glyphicon-music"></i> Single song mode: Stop after every song

##### Sound source
- **Êòì** Netease Music
- **ÂçÉ** Baidu Music Boxes
- **Ôºπ** YouTube
- **Áãó** Kugou
- **Êàë** Kuwu

##### Search Keyword and Play

Enter keywords and function keys to query.
Directly after input:
- Enter to press the left function key.
- Shift + Enter to press the middle function key.
- Ctrl + Enter to press the right function key.

### Function keys (no keywords):

![](https://i.imgur.com/lUoXg90.png)

<i class="glyphicon glyphicon-list"></i> Expand the list to play <i class="glyphicon glyphicon-play"></i> Play the first song in playlist <i class="glyphicon glyphicon-heart"></i> Expand favorites list

---

![](https://i.imgur.com/BaeZgDK.png)

<i class="glyphicon glyphicon-remove"></i> Remove from playlist <i class="glyphicon glyphicon-play"></i> play the song <i class="glyphicon glyphicon-heart"></i> add to favorites

---

![](https://i.imgur.com/G2MhLFm.png)

<i class="glyphicon glyphicon-plus"></i> Add to playlist <i class="glyphicon glyphicon-play"></i> Play now <i class="glyphicon glyphicon-remove"></i> Remove from favorites

---



### Function keys (with keywords)

![](https://i.imgur.com/zqXoPW8.png)

<i class="glyphicon glyphicon-search"></i> Expand results <i class="glyphicon glyphicon-play"></i> Play the most relevant song <i class="glyphicon glyphicon-plus"></i> Add the most relevant song to playlist

---

![](https://i.imgur.com/dp0X0a8.png)

<i class="glyphicon glyphicon-plus"></i> Add to playlist <i class="glyphicon glyphicon-play"></i> Play now <i class="glyphicon glyphicon-heart"></i> Add to favorites

---



#### GamePanel

![](https://i.imgur.com/nMHidhk.png)

Select a game and it will only start when selected.

#### LineSticker

![](https://i.imgur.com/fcQCFBW.png)

<i class="glyphicon glyphicon-refresh"></i> restore the ten preset stickers
<i class="glyphicon glyphicon-plus"></i> Add stickers
<i class="glyphicon glyphicon-minus"></i> delete the selected texture
<i class="glyphicon glyphicon-shopping-cart"></i> Go to the sticker website

## Background settings

<i class="glyphicon glyphicon-question-sign"></i> Go to the help page <i class="glyphicon glyphicon-info-sign"></i> About the author <i class="glyphicon glyphicon-refresh"></i> Reset all settings
Click HELP to open the introduction page of the setting.

![](https://i.imgur.com/JllLXvZ.png)


### Quick Regex Tester (Quick Regular Expression Test)

Quick test for easy rule setting

### Music Delay

In continuous playback mode, songs and songs are spaced.
(There is a synchronization problem between room members, sometimes songs will be covered, so the delay is set)

### Timer Configuration

Function: Perform the defined action regularly.



```js
Minutes, "function", ["parameter", ...]
```

Function ["parameter", ...] Description:

- `msg` `["message", "message", ...] `
  Select a message to publish.
- `umsg` `["URL", "Message", ...] `
  Publish the URL and a randomly selected message.
- `dm` `["username", "message", "message", ...] `
  Select a message to dm the username.
- `udm` `["username", "URL", "message", ...] `
  Private messaging users, with a URL and a randomly selected message.
- `kick` `["username"] `
  Kick out the user.
- `ban` `["username"] `
  Kick out and ban the user.
- `banrpt` `["username"] `
  Kick out, ban and report the user.
- `plym` `["Song Keywords"] `
  `plym` `["Song Keyword", "Number"] `
  `plym` `["Song Keyword", "Sound Source"] `
  `plym` `["Song Keyword", "Number", "Sound Source"] `
  `plym` `["Song Keyword", "Sound Source", "Number"] `
  play music.
  1. "Keywords": Song keywords.
  2. "Number": Index of search results.
  3. "Sound Source": Sound source. Currently there are "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `addm` `["Song Keywords"] `
  `addm` `["Song Keywords", "Number"] `
  `addm` `["Song Keyword", "Sound Source"] `
  `addm` `["Song Keyword", "Number", "Sound Source"] `
  `addm` `["Song Keyword", "Sound Source", "Number"] `
  Add music to your playlist.
  1. "Keywords": Song keywords.
  2. "Number": Index of search results.
  3. "Sound Source": There are currently "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `delm` `["number"] `
  Remove music (by index number) from the list.
- `lstm` `[] `
  show the playlist.
- `nxtm` `[] `
  Play the next song.
- `pndm` `[] `
  `pndm` `["Song Keywords"] `
  `pndm` `["song keyword", "number"] `
  `pndm` `["Song Keyword", "Sound Source"] `
  `pndm` `["song keyword", "number", "audio source"] `
  `pndm` `["song keyword", "sound source", "number"] `
  If there is no parameter, the list to be played is listed.
  If there is no music currently, play music.
  If there is music, add it to the list
  If the keyword is an empty string, list it for play.
  1. "Keywords": Song keywords.
  2. "Number": Index of search results.
  3. "Sound Source": Sound source. Currently there are "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `schm` `["Song Keyword"] `
  `schm` `["Song Keyword", "Sound Source"] `
  List search results.
  1. "Keywords": Song keywords.
  2. "Sound Source": There are currently "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `horm` `["username"] `
  Transfer owner permissions to the user.
- `ocdr` `[] `
  Leaving the room and entering the room again.
- `gofr` `["Room Name (RegExp)"] `
  Go to the room that matches the room name. If it fails, return to the origin room.
  
(`Me` can be achieved in msg with` / me + push message`) ~

You can use special time variables in parameters:

- `%Y` year, four-digit year
- `%Âπ¥` year, Chinese numerals
- `%M` month, one or two digits
- `%Êúà` month, Chinese numerals (one to twelve)
- `%D` date, one or two digits
- `%Êó•` date, Chinese numerals
- `%d` weekday, full English
- `%Êòü` week, Chinese
- Number at `%H` (24 hour clock)
- number at `%h` (12 hours)
- `%c` In the afternoon, English` a.m.` `p.m.`
- `%m` minutes, numbers
- `%s` seconds, numbers
- `%%` escape character `%`



example:
```js
10, "msg", ["every 10 mins report once!"]
2, "msg", ["It's a Report Message", "Now is%H:%m!"]
```
### Welcome Configuration

Function: After someone enters the room, if the name matches [regular expression](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp#), the greeting will be sent out automatically .
Format: Two formats, multiple welcome words (choose randomly and send out)
```js
"Username (regular expression)", "Welcome"
"Username (regular expression)", ["Hola", "Hello", ...]
```

note:
- Match from top to bottom. If the match is successful, the following rule will not be matched.
- The empty string `""` or the regular string `".*"` Can **match all**.


Special variables:
- `$user` The name of the member who entered the room.
- `$$` escape character `$`.

Example: Say `hello, kitty` to users who have lambda in their name followed by cat (possibly with some words in between), and `hello/HI!! `to others.

```js
"lambda.*cat", "hello, kitty"
".*", ["hello $user", "HI !! $user"]
```

### WhiteList Configuration

Function: Use [regular expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp#) to automatically kick out specifics ** not in the list ** user.
format:
```js
Username (regular expression)
```


Example: Only users whose names end with `cat` or begin with `mysterious` are allowed.

```js
cat$
^mysterious
```

### BlackList Configuration

Function: Use [regular expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp#) to automatically kick out specific uses in list.
format:
```js
Username (regular expression)
```



Example: kick out users who have `otoko` in their names and some qualified robots.

```js
otoko
.*Robot
```

### BanAbuse Configuration

Function: use [regular expressions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp#) to filter the chat content and automatically kick out **speak prohibited words** users.
format:
```js
Stop word (regular expression)
```


Example: Chats containing members who say `dog` or` foobar` will be kicked out.
```js
dog
foobar
```

### EventAction Configuration

Function: For some events, here are some functions that can order some corresponding actions.
The defined actions will be performed only when the **username** and the **contents sent by the user** match the [regular expression](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp#).
In fact, the previous functions: welcome words / whitelist / blacklist / banned words can be implemented with this function.

format:
```js
"Event type", "User name (regular expression)", "Content matching (regular expression)", "Function", ["Arguments", ...]
["Event type", ...], "User name (regular expression)", "Content matching (regular expression)", "Function", ["Arguments", ...]
```

Event type:

- `me` as` /me`
- `music` play music
- `leave` members leave
- `join` members join
- `msg` general message
- `dm` Private Message
- `musicend` music ends

Function ["parameter", ...] Description:

- `msg` `["message", "message", ...] `
  Select a message to publish.
- `umsg` `["URL", "Message", ...] `
  Publish the URL and a randomly selected message.
- `dm` `["username", "message", "message", ...] `
  Select a message to dm the username.
- `udm` `["username", "URL", "message", ...] `
  Private messaging users, with a URL and a randomly selected message.
- `kick` `["username"] `
  Kick out the user.
- `ban` `["username"] `
  Kick out and ban the user.
- `banrpt` `["username"] `
  Kick out, ban and report the user.
- `plym` `["Song Keywords"] `
  `plym` `["Song Keyword", "Number"] `
  `plym` `["Song Keyword", "Sound Source"] `
  `plym` `["Song Keyword", "Number", "Sound Source"] `
  `plym` `["Song Keyword", "Sound Source", "Number"] `
  play music.
  1. "Keywords": Song keywords.
  2. "Number": Index of search results.
  3. "Sound Source": Sound source. Currently there are "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `addm` `["Song Keywords"] `
  `addm` `["Song Keywords", "Number"] `
  `addm` `["Song Keyword", "Sound Source"] `
  `addm` `["Song Keyword", "Number", "Sound Source"] `
  `addm` `["Song Keyword", "Sound Source", "Number"] `
  Add music to your playlist.
  1. "Keywords": Song keywords.
  2. "Number": Index of search results.
  3. "Sound Source": Sound source. Currently there are "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `delm` `["number"] `
  Remove music (by index number) from the list.
- `lstm` `[] `
  show the playlist.
- `nxtm` `[] `
  Play the next song.
- `pndm` `[] `
  `pndm` `["Song Keywords"] `
  `pndm` `["song keyword", "number"] `
  `pndm` `["Song Keyword", "Sound Source"] `
  `pndm` `["song keyword", "number", "audio source"] `
  `pndm` `["song keyword", "sound source", "number"] `
  If there is no parameter, the list to be played is listed.
  If there is no music currently, play music.
  If there is music, add it to the list
  If the keyword is an empty string, list it for play.
  1. "Keywords": Song keywords.
  2. "Number": Index of search results.
  3. "Sound Source": Sound source. Currently there are "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `schm` `["Song Keyword"] `
  `schm` `["Song Keyword", "Sound Source"] `
  List search results.
  1. "Keywords": Song keywords.
  2. "Sound Source": There are currently "ÂçÉ", "Êòì", "Êàë", "Áãó" and "Ôºπ" available.
- `horm` `["username"] `
  Transfer owner permissions to the user.
- `ocdr` `[] `
  Leaving the room and entering the room again.
- `gofr` `["Room Name (RegExp)"] `
  Go to the room that matches the room name. If it fails, return to the origin room.

Special parameter variables:

* `$user` username for sending message
* `$cont` content sent by the user
* `$args` User sends everything after the first space
   User sends: `play BUMP OF CHICKEN„Äå Hello, world! „Äç`
   `$args`:` BUMP OF CHICKEN "Hello, world!" `
* `$url` URL on user folder
* `$$` escape character `$`

There are some special uses here.
For received messages, the parameters are separated by spaces, and quotation marks are used to avoid separation.
For separate content, the following methods can be used as parameters.

- `$N` N is a number. Take the Nth parameter from the number, starting from zero.
- `$[N-M]` takes parameters from N to M. If N does not give, it will start from zero, and if M does not give, it will take to the end.

```
this is  a  message send from user
---- --  -  ------- ---- ---- ----
$0   $1  $2 $3      $4   $5   $6
----------------------------------
$cont

Send string:
this is a "another message" send from 'another user'

The quotes will be removed, but the spaces inside will not be cut:
this is a  another message  send from  another user
---- -- -  ---------------  ---- ----  ------------
$0   $1 $2 $3               $4   $5    $6
     ----------------------------------------------
     $args
---------  --------------------- ------------------
$[-2]      $[3-4]                $[5-]
---------------------------------------------------                     
$[-]

```

Example: Connect the song function.

```js
"msg", "", "^/play\\\\s+(\\\\D|\\\\d\\\\S)", "plym", ["$args"]
"msg", "", "^/play\\\\s+\\\\d\\\\s+\\\\S+", "plym", ["$[2-]", "$1"]
"msg", "", "^/playsrc\\\\s+[ÂçÉÊòì]\\\\s+(\\\\D|\\\\d\\\\S)", "plym", ["$[2-]"]
"msg", "", "^/playsrc\\\\s+[ÂçÉÊòì]\\\\s+\\\\d\\\\s+\\\\S+", "plym", ["$[3-]", "$1", "$2"]
"msg", "", "^/add\\\\s+(\\\\D|\\\\d\\\\S)", "addm", ["$args"]
"msg", "", "^/add\\\\s+\\\\d\\\\s+\\\\S+", "addm", ["$[2-]", "$1"]
"msg", "", "^/addsrc\\\\s+[ÂçÉÊòì]\\\\s+(\\\\D|\\\\d\\\\S)", "addm", ["$[2-]", "$1"]
"msg", "", "^/addsrc\\\\s+[ÂçÉÊòì]\\\\s+\\\\d\\\\s+\\\\S+", "addm", ["$[3-]", "$1", "$2"]
"msg", "", "^/list", "lstm", []
"msg", "", "^/next", "nxtm", []
"msg", "", "^/del\\\\s+\\\\d+", "delm", ["$1"]
"msg", "", "^/pending\\\\s*$", "pndm", []
"msg", "", "^/pending\\\\s+(\\\\D|\\\\d\\\\S)", "pndm", ["$args"]
"msg", "", "^/pending\\\\s+\\\\d\\\\s+\\\\S+", "pndm", ["$[2-]", "$1"]
"msg", "", "^/pendsrc\\\\s+[ÂçÉÊòì]\\\\s+(\\\\D|\\\\d\\\\S)", "pndm", ["$[2-]", "$1"]
"msg", "", "^/pendsrc\\\\s+[ÂçÉÊòì]\\\\s+\\\\d\\\\s+\\\\S+", "pndm", ["$[3-]", "$1", "$2"]
"msg", "", "^/sc\\\\s+([ÂçÉÊòì]\\\\S+|[^ÂçÉÊòì])", "schm", ["$args"]
"msg", "", "^/sc\\\\s+[ÂçÉÊòì]\\\\s+\\\\S+", "schm", ["$[2-]", "$1"]
```

The user sends the following strings to trigger the set function:

```
/play yellow
/play 2 yellow
/playsrc ÂçÉ yellow
/play Êòì 2 yellow
/add  21Guns
/add  2 21Guns
/addsrc ÂçÉ 21Guns
/addsrc Êòì 2 21Guns
/pending
/pending 21Guns
/pending 2 21Guns
/pendsrc ÂçÉ 21Guns
/pendsrc Êòì 2 21Guns
/del  1
/list
/next
/sc 21Guns
/sc ÂçÉ 21Guns
```
